<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>Analysing AlphaGo // teleported.in</title>

    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <meta property="og:title" content="Teleported.in" />
<meta property="og:description" content="A blog where I share my intuitions about artificial intelligence, machine learning, deep learning." />
<meta property="og:type" content="website" />
<meta property="og:locale" content="en_US" />
<meta property="og:url" content="http://teleported.in/posts/analysing-alphago/" />



    <link href="" rel="alternate" type="application/rss+xml" title="teleported.in" />
    <link rel="shortcut icon" type="image/png" href="/favicon.ico">

    <link href="http://teleported.in/webfonts/ptserif/main.css" rel='stylesheet' type='text/css'>
    <link href="http://teleported.in/webfonts/source-code-pro/main.css" rel="stylesheet" type="text/css">

    <link rel="stylesheet" href="http://teleported.in/css/style.css">

    <link href="http://gmpg.org/xfn/11" rel="profile">
    <meta http-equiv="content-type" content="text/html; charset=utf-8">

    
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">

    <meta name="description" content="A blog where I share my intuitions about artificial intelligence, machine learning, deep learning.">
    <meta name="keywords" content="ai ml artificial intelligence programming c++ python intuitions papers">
    <meta name="author" content="Anand Saha <anandsaha gmail com">

    <meta name="generator" content="Hugo 0.20.6" />
</head>


<body>
<div id="container">
    <header id="header">
    <div id="header-outer" class="outer">
        <div id="header-inner" class="inner">
            <a id="main-nav-toggle" class="nav-icon" href="javascript:;"></a>
            <a id="logo" class="logo-text" href="http://teleported.in/">teleported.in</a>
            <nav id="main-nav">
                
                <a class="main-nav-link" href="/about/about">About</a>
                
                <a class="main-nav-link" href="/posts/">Posts</a>
                
            </nav>
            <nav id="sub-nav">
                <div id="search-form-wrap">
                </div>
            </nav>
        </div>
        <div style="margin-top:-10px; padding-bottom:5px">
        <label style="font-family: Arial, Georgia;color:#555555">
            My notes on AI and ML. Mostly intuitions and concepts.</label>
        </div>
    </div>
</header>

    <section id="main" class="outer">
        <article class="article article-type-post" itemscope itemprop="blogPost">
    <div class="article-inner">
        
        <header class="article-header">
            <h1 class="article-title" itemprop="name">Analysing AlphaGo</h1>
        </header>
        
        <div class="article-meta">
            <a href="/posts/analysing-alphago/" class="article-date">
                <time datetime='2017-05-12T23:27:27.000-04:00' itemprop="datePublished">2017-05-12</time>
            </a>
            
            
            <div class="post-categories">
                <div class="article-category">
                    
                    
                    <a class="article-category-link" href="http://teleported.in//categories/artificial-intelligence">artificial intelligence</a>
                    
                    
                    <span>|</span>
                    
                    <a class="article-category-link" href="http://teleported.in//categories/game-playing">game playing</a>
                    
                </div>
            </div>
            
            
            
            <div class="article-comment-link-wrap">
                <a href="/posts/analysing-alphago/#disqus_thread" class="article-comment-link">Comments</a>
            </div>
            
        </div>
        <div style="color:#999999;">
        By <a style="text-decoration: none;color:#999999; border-bottom: 1px dotted #000;" href="/about/about">Anand Saha</a>
        </div>
        <div class="article-entry" itemprop="articleBody">
            

<p>(<em>I wrote this piece as part of an assignment for Udacity&rsquo;s <a href="https://in.udacity.com/course/artificial-intelligence-nanodegree--nd889/">AI Nanodegree program</a></em>)</p>

<h3 id="introduction">Introduction</h3>

<p>&lsquo;Go&rsquo; is typically an adversarial <a href="/posts/ai-search-algorithms/">search problem</a> where the objective is to find the best move for the AI Agent to defeat it&rsquo;s opponent, given a board position. Go is a two player, turn taking, deterministic game of perfect information.</p>

<p><img style="width: 300px; padding:10px 30px 10px 10px" src="/post_imgs/04-alphago.jpg"></p>

<p>Two main factors make Go very complex to solve:</p>

<ul>
<li>Go has an average branching factor &lsquo;<em>b</em>&rsquo; of ~250 options per node (chess ~35)</li>
<li>Go has an average depth &lsquo;<em>d</em>&rsquo; of ~150 moves (chess ~80)</li>
</ul>

<p>These factos make the state space of Go (<em>b<sup>d</sup></em>) enormous to search end to end using traditional techniques.</p>

<h3 id="what-did-alphago-achieve">What did AlphaGo achieve?</h3>

<p><a href="https://storage.googleapis.com/deepmind-media/alphago/AlphaGoNaturePaper.pdf">AlphaGo</a> became the first computer Go program in the world <a href= "https://en.wikipedia.org/wiki/AlphaGo" >to have beaten a human professional Go player without handicaps on a full-sized 19x19 board.</a></p>

<p>AlphaGo achieved this at a time when the community had estimated another decade for this to be a reality.</p>

<h3 id="how-did-it-achieve-this-feat">How did it achieve this feat?</h3>

<p>The solution to solving a game problem of this magnitude is to be able to reduce the enormous search space to something more managable<sup>3</sup>. Additionally, the system is trained to learn how successfull moves look like, by exposing it to results of actual games played in the past.</p>

<p>Theoretically, there are (mainly) two ways in which the search space of a game tree may be traversed intelligently, keeping time and memory constraints in mind:</p>

<ul>
<li><em>Limiting the <a href="https://en.wikipedia.org/wiki/Branching%5ffactor">branching factor</a> b</em> by pruning away branches which are guarenteed not to have the best moves (e.g. using alpha beta pruning)</li>
<li><em>Limiting the <a href="https://en.wikipedia.org/wiki/Tree-depth">game tree depth</a> d</em> by using evaluation functions, which gives an estimation of a board position at a certain depth, without expanding the board further (e.g. using heuristics)</li>
</ul>

<p>AlphaGo makes use of these techniques in a very sophisticated (and deviated) way to achieve wins. <em>Deviated</em> because it doesn&rsquo;t make use of traditional search trees directly, but uses MCTS, which works very well on huge search spaces.</p>

<p>There are 3 important pieces to the AlphaGo&rsquo;s algorithm:</p>

<ol>
<li>It uses a deep neural network, called the &ldquo;policy network&rdquo;, to <em>predict</em> the next set of moves which are likely to win (thereby reducing the branching factor)</li>
<li>It uses a deep neural network, called the &ldquo;value network&rdquo;, to <em>estimate</em> the outcome (win/loss) of a board position without actually traversing till the end (thereby reducing the depth)</li>
<li>It uses Monte Carlo tree search (MCTS) which makes use of (1) and (2) to determine the best move given a board state</li>
</ol>

<p>The best way to start understanding AlphaGo&rsquo;s algorithm is to understand what MCTS is and what problem it solves. Once that is understood, it becomes easy to understand how <em>Policy networks</em> and <em>Value networks</em> fit in.</p>

<h4 id="monte-carlo-tree-search">Monte Carlo Tree Search</h4>

<p>The usual approach to solving a game problem is to create a search tree and apply one of the many search algorithms to find the next move. However, Go&rsquo;s search space being enormous, this approach would fall dramatically short in performance.</p>

<p>MCTS is a technique to search huge (game) trees with arbitrary branching factor. It also allows you to time limit your search so that you come out with the best move that was possible to find within the given time (usually needed in competitive games).</p>

<p><img src="/post_imgs/04-mcts.png" alt="MCTS" />
Steps in MCTS <em>Source: researchgate.net</em></p>

<p>The intuition behind MCTS is that:</p>

<ul>
<li>When you are at a certain state, you have knowledge of the tree only to a certain depth beyond which you haven&rsquo;t expanded the tree yet. (Remember, this is an enormous tree.)</li>
<li><strong>Selection</strong>: When you are at a state (node) in the tree, you try to select an action to traverse to the next state, which has high probability of winning. But which one will you select? This is given by the policy function. The policy function takes in a state and gives back an action which has high probability of winning. That&rsquo;s where the policy network comes into picture. You keep selecting subsequent actions until you come to a leaf state (this is not leaf of the <em>actual</em> tree, this is leaf of the <em>known</em> tree)</li>
<li><strong>Expansion</strong>: Once you have reached a leaf state, it might have many different possibilities. It is possible that at this state, there are very many possible actions to take to reach various states. You randomly take a few actions to create a few different child states.<br /></li>
<li><strong>Simulation</strong>: In this step, take the child states created above and simulate a game by taking actions choosen based on a policy. This is called a rollout policy. A simple policy can be the random policy. Each of these simulations will eventually converge to a win or lose state.</li>
<li><strong>Back Propagation</strong>: In this state, the win or lose evaluation is propagated up through the path up to root. The statistics of various wins or loses due to such simulations is recorded in each node. Eventually, a winning path emerges.</li>
</ul>

<h4 id="the-policy-network">The Policy Network</h4>

<p>As stated earlier, the policy network helps AlphaGo predict the set of next winning moves. The policy network was trained on 30 million moves collected from previously played games by humans. This is a form of supervised learning. Post this the network was made to play itself thousands of times via reinforcement learning. Reinforecement learning helped policy network to discover new strategies apart from what humans have used.</p>

<h4 id="the-value-network">The Value Network</h4>

<p>The value network is training using the policy network via reinforcement learning.</p>

<h4 id="so-putting-it-together">So, putting it together</h4>

<h4 id="conclusion">Conclusion</h4>

<p>References:</p>

<ol>
<li><a href="https://storage.googleapis.com/deepmind-media/alphago/AlphaGoNaturePaper.pdf">AlphaGo Paper</a></li>
<li><a href="https://www.tastehit.com/blog/google-deepmind-alphago-how-it-works/">TasteHit blog post</a></li>
<li><a href="https://research.googleblog.com/2016/01/alphago-mastering-ancient-game-of-go.html">Google blog post</a></li>
<li><a href="https://en.wikipedia.org/wiki/Monte_Carlo_tree_search">Monte Carlo Tree Search</a></li>
<li><a href="https://datascience.stackexchange.com/questions/10932/difference-between-alphagos-policy-network-and-value-network">StackExchange discussion</a></li>
</ol>

        </div>

        
        
        <div class="article-toc" style="display:none;">
            <h3>Contents</h3>
            <nav id="TableOfContents">
<ul>
<li>
<ul>
<li>
<ul>
<li><a href="#introduction">Introduction</a></li>
<li><a href="#what-did-alphago-achieve">What did AlphaGo achieve?</a></li>
<li><a href="#how-did-it-achieve-this-feat">How did it achieve this feat?</a>
<ul>
<li><a href="#monte-carlo-tree-search">Monte Carlo Tree Search</a></li>
<li><a href="#the-policy-network">The Policy Network</a></li>
<li><a href="#the-value-network">The Value Network</a></li>
<li><a href="#so-putting-it-together">So, putting it together</a></li>
<li><a href="#conclusion">Conclusion</a></li>
</ul></li>
</ul></li>
</ul></li>
</ul>
</nav>
        </div>
        
        

        
        <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.1.1/jquery.slim.min.js" integrity="sha256-/SIrNqv8h6QGKDuNoLGA4iret+kyesCkHGzVUUV0shc=" crossorigin="anonymous"></script>
        <script>
            (function() {
                var $toc = $('#TableOfContents');
                if ($toc.length > 0) {
                    var $window = $(window);

                    function onScroll(){
                        var currentScroll = $window.scrollTop();
                        var h = $('.article-entry h1, .article-entry h2, .article-entry h3, .article-entry h4, .article-entry h5, .article-entry h6');
                        var id = "";
                        h.each(function (i, e) {
                            e = $(e);
                            if (e.offset().top - 10 <= currentScroll) {
                                id = e.attr('id');
                            }
                        });
                        var active = $toc.find('a.active');
                        if (active.length == 1 && active.eq(0).attr('href') == '#' + id) return true;

                        active.each(function (i, e) {
                            $(e).removeClass('active').siblings('ul').hide();
                        });
                        $toc.find('a[href="#' + id + '"]').parentsUntil('#TableOfContents').each(function (i, e) {
                            $(e).children('a').addClass('active').siblings('ul').show();
                        });
                    }

                    $window.on('scroll', onScroll);
                    $(document).ready(function() {
                        $toc.find('a').parent('li').find('ul').hide();
                        onScroll();
                        document.getElementsByClassName('article-toc')[0].style.display = '';
                    });
                }
            })();
        </script>
        


        
        <footer class="article-footer">
            <ul class="article-tag-list">
                
                <li class="article-tag-list-item">
                    <a class="article-tag-list-link" href="http://teleported.in//tags/intuitions">intuitions
                    </a>
                </li>
                
                <li class="article-tag-list-item">
                    <a class="article-tag-list-link" href="http://teleported.in//tags/alphago">alphago
                    </a>
                </li>
                
                <li class="article-tag-list-item">
                    <a class="article-tag-list-link" href="http://teleported.in//tags/ai">ai
                    </a>
                </li>
                
                <li class="article-tag-list-item">
                    <a class="article-tag-list-link" href="http://teleported.in//tags/research">research
                    </a>
                </li>
                
                <li class="article-tag-list-item">
                    <a class="article-tag-list-link" href="http://teleported.in//tags/google">google
                    </a>
                </li>
                
                <li class="article-tag-list-item">
                    <a class="article-tag-list-link" href="http://teleported.in//tags/go">go
                    </a>
                </li>
                
            </ul>
        </footer>
        
    </div>
    <nav id="article-nav">
    
    <a href="/posts/ai-ml-readings/" id="article-nav-newer" class="article-nav-link-wrap">
        <div class="article-nav-title"><span>&lt;</span>&nbsp;
            AI/ML Readings (living doc)
        </div>
    </a>
    
    
    <a href="/posts/ai-search-algorithms/" id="article-nav-older" class="article-nav-link-wrap">
        <div class="article-nav-title">Visualising AI Search Algorithms&nbsp;<span>&gt;</span></div>
    </a>
    
</nav>
</article>

        
            <div id="disqus_thread"></div>
<script type="text/javascript">
    var disqus_shortname = 'teleported-in';
    var disqus_identifier = 'http:\/\/teleported.in\/posts\/analysing-alphago\/';
    var disqus_title = 'Analysing AlphaGo';
    var disqus_url = 'http:\/\/teleported.in\/posts\/analysing-alphago\/';

    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
        
    </section>
    <footer id="footer">
    <div class="outer">
        <div id="footer-info" class="inner">
            
            &copy; 2017 <a href="https://www.linkedin.com/in/anandsaha/">Anand Saha</a> &nbsp; 
            Powered by <a href="https://gohugo.io" target="_blank">Hugo</a> with theme <a href="https://github.com/carsonip/hugo-theme-minos">Minos</a>
        </div>
    </div>
    
<script>
window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
ga('create', 'UA-98287631-1', 'auto');
ga('send', 'pageview');
</script>
<script async src='//www.google-analytics.com/analytics.js'></script>


    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.9.0/styles/tomorrow-night.min.css" integrity="sha256-2wL88NKUqvJi/ExflDzkzUumjUM73mcK2gBvBBeLvTk=" crossorigin="anonymous" />
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.9.0/highlight.min.js" integrity="sha256-KbfTjB0WZ8vvXngdpJGY3Yp3xKk+tttbqClO11anCIU=" crossorigin="anonymous"></script>
    <script>hljs.initHighlightingOnLoad();</script>

    
    <script>
        document.getElementById('main-nav-toggle').addEventListener('click', function () {
            var header = document.getElementById('header');
            if (header.classList.contains('mobile-on')) {
                header.classList.remove('mobile-on');
            } else {
                header.classList.add('mobile-on');
            }
        });
    </script>
</footer>

</div>
</body>
</html>
